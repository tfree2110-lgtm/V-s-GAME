<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>VICTORIA'S GAME ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { background: #fff0f5; margin: 0; height: 100vh; overflow: hidden; display: flex; justify-content: center; font-family: 'Arial Rounded MT Bold', sans-serif; }
        #game-wrapper { width: 100%; max-width: 400px; height: 100%; display: flex; flex-direction: column; align-items: center; position: relative; padding: env(safe-area-inset-top) 15px 10px 15px; }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 240, 245, 0.98); z-index: 1000; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .hidden { display: none !important; }
        #bonus-counter { background: white; color: #ff85c1; padding: 4px 10px; border-radius: 12px; font-size: 11px; margin-top: 5px; border: 2px solid #ffb3d9; font-weight: bold; }
        
        #found-words-container {
            height: 180px; 
            width: 100%; 
            margin-top: 10px;
            display: flex; 
            flex-wrap: wrap; 
            gap: 8px; 
            justify-content: center; 
            background: rgba(255, 255, 255, 0.6); 
            padding: 15px; 
            border-radius: 15px; 
            border: 2px dashed #ffb3d9; 
            overflow-y: auto; 
            touch-action: pan-y; 
            -webkit-overflow-scrolling: touch;
        }

        .word-box { background: white; padding: 6px 10px; border-radius: 8px; font-size: 13px; font-weight: bold; color: #ffb3d9; border: 1.5px solid #ffb3d9; min-width: 50px; text-align: center; letter-spacing: 1px; }
        .word-box.found { background: #ff85c1; color: white; border-color: #ff4da6; transform: scale(1.05); }
        
        #preview-box { height: 40px; font-size: 26px; font-weight: bold; color: #ff4da6; margin-top: 10px; }
        #interaction-area { position: relative; width: 260px; height: 260px; margin-top: 5px; display: flex; justify-content: center; align-items: center; touch-action: none; }
        #line-canvas { position: absolute; top: 0; left: 0; pointer-events: none; z-index: 5; }
        #back-btn, #shuffle-btn, #hint-btn { background: white; border: 3px solid #ffb3d9; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 0 #ffb3d9; }
        #back-btn { position: absolute; top: 15px; left: 15px; z-index: 1100; width: 50px; height: 50px; font-size: 24px; }
        #shuffle-btn { position: absolute; bottom: 0px; right: 0px; width: 50px; height: 50px; font-size: 22px; z-index: 60; }
        #hint-btn { width: 60px; height: 60px; font-size: 24px; z-index: 20; position: relative; }
        .letter-bubble { position: absolute; width: 54px; height: 54px; background: white; color: #ff4da6; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; border: 3px solid #ffb3d9; box-shadow: 0 5px 0 #ffb3d9; z-index: 10; }
        .letter-bubble.active { background: #ffb3d9; color: white; transform: scale(1.1); }
        .ribbon { background: #ff85c1; color: white; padding: 8px 18px; border-radius: 20px; border: 3px solid white; font-size: 14px; }
        .kawaii-card { background: white; padding: 25px; border-radius: 35px; border: 5px solid #ff85c1; text-align: center; width: 90%; box-shadow: 0 10px 0 #ffb3d9; }
        .menu-btn { background: #ff85c1; color: white; border: none; padding: 15px; border-radius: 30px; font-size: 18px; font-weight: bold; box-shadow: 0 5px 0 #e667a3; margin-bottom: 12px; width: 100%; }
        .restart-btn { background: #e0e0e0; color: #757575; box-shadow: 0 5px 0 #bdbdbd; font-size: 14px; }
        #success-popup { position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%) scale(0); background: white; padding: 20px; border-radius: 25px; border: 4px solid #ff85c1; z-index: 2000; font-size: 18px; font-weight: bold; transition: 0.3s; width: 80%; text-align: center; }
        #success-popup.show { transform: translate(-50%, -50%) scale(1); }
    </style>
</head>
<body>
    <div id="game-wrapper">
        <button id="back-btn" class="hidden" onclick="goToMenu()">üè†</button>
        <div id="home-screen" class="overlay"><div class="kawaii-card"><h1>HEY LIL MOMMA</h1><p>Ready to play?</p><button class="menu-btn" onclick="showLevelMenu()">START GAME üéÄ</button></div></div>
        
        <div id="level-menu" class="overlay hidden">
            <div class="kawaii-card">
                <h2>Choose a Level</h2>
                <button class="menu-btn" onclick="startGame('easy')">EASY</button>
                <button class="menu-btn" onclick="startGame('medium')">MEDIUM</button>
                <button class="menu-btn" onclick="startGame('hard')">HARD</button>
                <button class="menu-btn" onclick="goToMenu()">BACK</button>
                <hr style="border: 1px dashed #ffb3d9; margin: 10px 0;">
                <button class="menu-btn restart-btn" onclick="fullReset()">RESTART ALL PROGRESS üóëÔ∏è</button>
            </div>
        </div>

        <div id="win-screen" class="overlay hidden"><div class="kawaii-card"><h2>LEVEL CLEAR!! ‚ù§Ô∏è</h2><p id="win-message"></p><button class="menu-btn" onclick="resetAndGoToMenu()">PLAY AGAIN üéÄ</button></div></div>
        <div class="kawaii-header"><div class="ribbon">üéÄ VICTORIA'S WORD GAME üéÄ</div><div id="bonus-counter" class="hidden">Bonus: 0</div></div>
        <div id="success-popup">GOOD JOB ‚ù§Ô∏è</div>
        <div id="found-words-container"></div>
        <div id="preview-box"><span id="word-preview"></span></div>
        <div id="interaction-area"><button id="hint-btn" class="hidden" onclick="useHint()">üí°</button><button id="shuffle-btn" class="hidden" onclick="shuffleLetters()">üîÑ</button><canvas id="line-canvas" width="260" height="260"></canvas><div id="letter-ring"></div></div>
    </div>
    <script>
        const levels = {
            easy: { letters: ['S', 'T', 'A', 'R'], words: ['STAR', 'ARTS', 'RATS', 'TARS', 'ART', 'RAT', 'SAT', 'TAR'], bonus: ['AS', 'AT'] },
            medium: { letters: ['P', 'O', 'S', 'T'], words: ['POST', 'POTS', 'STOP', 'TOPS', 'OPTS', 'POT', 'TOP', 'OPT'], bonus: ['SO', 'TO'] },
            hard: { letters: ['S', 'P', 'A', 'R', 'E', 'D'], words: ['SPARED', 'SPREAD', 'SPEARS', 'SPARES', 'SPARE', 'SPEAR', 'READS', 'DARES', 'PEARS', 'PARED', 'REAPS', 'REAP', 'DARE', 'READ', 'DEAR', 'PEAR', 'SPA', 'RED', 'ARE', 'EAR', 'RAP', 'PAD', 'SAD'], bonus: ['APE', 'APES', 'PAR', 'ERA', 'ERAS', 'ADS', 'SEA', 'PER', 'ASP', 'RAD', 'RES', 'SAP', 'PARE', 'REPS', 'REDS', 'EARS', 'RAPS', 'PADS'] }
        };
        const winMessages = { easy: "SMARTY PANTS! NEXT LEVEL? üòâ", medium: "GENIUS! ‚ù§Ô∏è", hard: "I LOVE YOU SO MUCH! YOU BEAT IT! üòä" };
        let currentLevel = 'easy', foundWords = [], bonusWordsFound = [], isSwiping = false, currentSelection = [], letterPositions = [];
        const canvas = document.getElementById('line-canvas'), ctx = canvas.getContext('2d'), preview = document.getElementById('word-preview');
        
        function showLevelMenu() { document.getElementById('home-screen').classList.add('hidden'); document.getElementById('level-menu').classList.remove('hidden'); }
        function goToMenu() { location.reload(); }
        function resetAndGoToMenu() { goToMenu(); }
        function fullReset() { if(confirm("Clear all your found words and start over? ‚ù§Ô∏è")) { localStorage.clear(); location.reload(); } }

        function startGame(levelKey) {
            currentLevel = levelKey;
            document.getElementById('level-menu').classList.add('hidden');
            ['back-btn', 'shuffle-btn', 'hint-btn', 'bonus-counter'].forEach(id => document.getElementById(id).classList.remove('hidden'));
            const saved = localStorage.getItem('vicky_game_' + levelKey);
            foundWords = saved ? JSON.parse(saved) : [];
            const container = document.getElementById('found-words-container');
            container.innerHTML = '';
            [...levels[currentLevel].words].sort((a,b)=>a.length-b.length).forEach(w => {
                const div = document.createElement('div'); div.className = 'word-box'; div.id = 'slot-'+w;
                div.innerText = foundWords.includes(w) ? w.split('').join(' ') : "_ ".repeat(w.length).trim();
                if(foundWords.includes(w)) div.classList.add('found');
                container.appendChild(div);
            });
            renderLetters();
        }
        function renderLetters() {
            const ring = document.getElementById('letter-ring'); ring.innerHTML = ''; letterPositions = [];
            const radius = 95;
            levels[currentLevel].letters.forEach((char, i) => {
                const angle = (i / levels[currentLevel].letters.length) * Math.PI * 2 - Math.PI / 2;
                const x = 130 + radius * Math.cos(angle), y = 130 + radius * Math.sin(angle);
                const bubble = document.createElement('div'); bubble.className = 'letter-bubble'; bubble.innerText = char;
                bubble.style.left = (x-27)+'px'; bubble.style.top = (y-27)+'px'; ring.appendChild(bubble);
                letterPositions.push({ x, y, char, el: bubble });
            });
            canvas.width = 260; canvas.height = 260;
        }
        function useHint() {
            const unfound = levels[currentLevel].words.filter(w => !foundWords.includes(w));
            if (unfound.length === 0) return;
            const target = unfound[Math.floor(Math.random() * unfound.length)];
            const slot = document.getElementById('slot-' + target);
            let arr = slot.innerText.split(' ');
            let idx = arr.indexOf("_");
            if (idx !== -1) {
                arr[idx] = target[idx];
                slot.innerText = arr.join(' ');
                if (!arr.includes("_")) {
                    slot.classList.add('found');
                    foundWords.push(target);
                    localStorage.setItem('vicky_game_' + currentLevel, JSON.stringify(foundWords));
                    if (foundWords.length === levels[currentLevel].words.length) handleWin();
                }
            }
        }
        function processInput(clientX, clientY) {
            if (!isSwiping) return;
            const rect = canvas.getBoundingClientRect();
            const x = clientX - rect.left, y = clientY - rect.top;
            letterPositions.forEach(lp => {
                const dist = Math.hypot(lp.x - x, lp.y - y);
                if (dist < 28 && !currentSelection.includes(lp)) {
                    currentSelection.push(lp); lp.el.classList.add('active');
                    preview.innerText = currentSelection.map(s => s.char).join('');
                }
            });
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (currentSelection.length > 0) {
                ctx.beginPath(); ctx.strokeStyle = '#ff85c1'; ctx.lineWidth = 10; ctx.lineCap = 'round';
                currentSelection.forEach((lp, i) => { if (i === 0) ctx.moveTo(lp.x, lp.y); else ctx.lineTo(lp.x, lp.y); });
                ctx.lineTo(x, y); ctx.stroke();
            }
        }
        function endSwipe() {
            if (!isSwiping) return;
            const word = currentSelection.map(s => s.char).join('');
            const data = levels[currentLevel];
            const popup = document.getElementById('success-popup');
            if (data.words.includes(word)) {
                if (!foundWords.includes(word)) {
                    foundWords.push(word);
                    localStorage.setItem('vicky_game_' + currentLevel, JSON.stringify(foundWords));
                    const slot = document.getElementById('slot-' + word);
                    slot.innerText = word.split('').join(' '); slot.classList.add('found');
                    popup.innerText = "GOOD JOB ‚ù§Ô∏è"; popup.classList.add('show');
                    setTimeout(() => popup.classList.remove('show'), 1000);
                    if (foundWords.length === data.words.length) handleWin();
                }
            } else if (data.bonus && data.bonus.includes(word)) {
                if (!bonusWordsFound.includes(word)) {
                    bonusWordsFound.push(word);
                    document.getElementById('bonus-counter').innerText = "Bonus: " + bonusWordsFound.length;
                    popup.innerText = "BONUS! +1 LETTER ‚ú®"; popup.classList.add('show');
                    setTimeout(() => popup.classList.remove('show'), 1000);
                    useHint();
                }
            }
            isSwiping = false; currentSelection = [];
            letterPositions.forEach(lp => lp.el.classList.remove('active'));
            preview.innerText = ''; ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
        function handleWin() { confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } }); document.getElementById('win-message').innerText = winMessages[currentLevel]; setTimeout(() => { document.getElementById('win-screen').classList.remove('hidden'); }, 1000); }
        function shuffleLetters() { const chars = levels[currentLevel].letters; for (let i = chars.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [chars[i], chars[j]] = [chars[j], chars[i]]; } renderLetters(); }
        const gameArea = document.getElementById('interaction-area');
        gameArea.addEventListener('touchstart', (e) => { if (e.target.id === 'hint-btn' || e.target.id === 'shuffle-btn') return; isSwiping = true; processInput(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
        gameArea.addEventListener('touchmove', (e) => { if (isSwiping) { processInput(e.touches[0].clientX, e.touches[0].clientY); e.preventDefault(); } }, {passive: false});
        gameArea.addEventListener('touchend', endSwipe);
        window.addEventListener('mouseup', endSwipe);
        gameArea.addEventListener('mousedown', (e) => { if (e.target.id === 'hint-btn' || e.target.id === 'shuffle-btn') return; isSwiping = true; processInput(e.clientX, e.clientY); });
        window.addEventListener('mousemove', (e) => { if(isSwiping) processInput(e.clientX, e.clientY); });
    </script>
</body>
</html>
